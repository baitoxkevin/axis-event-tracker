(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[343],{1444:(e,t,r)=>{Promise.resolve().then(r.bind(r,13070))},3998:(e,t,r)=>{"use strict";r.d(t,{$:()=>d});var a=r(95155);r(12115);var s=r(32467),l=r(83101),i=r(64269);let n=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function d(e){let{className:t,variant:r,size:l,asChild:d=!1,...c}=e,o=d?s.DX:"button";return(0,a.jsx)(o,{"data-slot":"button",className:(0,i.cn)(n({variant:r,size:l,className:t})),...c})}},11186:(e,t,r)=>{"use strict";r.d(t,{bq:()=>u,eb:()=>h,gC:()=>m,l6:()=>c,yv:()=>o});var a=r(95155);r(12115);var s=r(25478),l=r(24033),i=r(5917),n=r(12108),d=r(64269);function c(e){let{...t}=e;return(0,a.jsx)(s.bL,{"data-slot":"select",...t})}function o(e){let{...t}=e;return(0,a.jsx)(s.WT,{"data-slot":"select-value",...t})}function u(e){let{className:t,size:r="default",children:i,...n}=e;return(0,a.jsxs)(s.l9,{"data-slot":"select-trigger","data-size":r,className:(0,d.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[i,(0,a.jsx)(s.In,{asChild:!0,children:(0,a.jsx)(l.A,{className:"size-4 opacity-50"})})]})}function m(e){let{className:t,children:r,position:l="popper",align:i="center",...n}=e;return(0,a.jsx)(s.ZL,{children:(0,a.jsxs)(s.UC,{"data-slot":"select-content",className:(0,d.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,align:i,...n,children:[(0,a.jsx)(x,{}),(0,a.jsx)(s.LM,{className:(0,d.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:r}),(0,a.jsx)(p,{})]})})}function h(e){let{className:t,children:r,...l}=e;return(0,a.jsxs)(s.q7,{"data-slot":"select-item",className:(0,d.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...l,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(s.VF,{children:(0,a.jsx)(i.A,{className:"size-4"})})}),(0,a.jsx)(s.p4,{children:r})]})}function x(e){let{className:t,...r}=e;return(0,a.jsx)(s.PP,{"data-slot":"select-scroll-up-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(n.A,{className:"size-4"})})}function p(e){let{className:t,...r}=e;return(0,a.jsx)(s.wn,{"data-slot":"select-scroll-down-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(l.A,{className:"size-4"})})}},11647:(e,t,r)=>{"use strict";r.d(t,{E:()=>d});var a=r(95155);r(12115);var s=r(32467),l=r(83101),i=r(64269);let n=(0,l.F)("inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:r,asChild:l=!1,...d}=e,c=l?s.DX:"span";return(0,a.jsx)(c,{"data-slot":"badge",className:(0,i.cn)(n({variant:r}),t),...d})}},13070:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>eu});var a=r(95155),s=r(12115),l=r(20063),i=r(64269);function n(e){let{title:t,description:r,actions:s,className:l}=e;return(0,a.jsxs)("div",{className:(0,i.cn)("mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",l),children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:t}),r&&(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:r})]}),s&&(0,a.jsx)("div",{className:"flex items-center gap-2",children:s})]})}var d=r(6132),c=r(24722),o=r(65229),u=r(21786),m=r(3998),h=r(18332);function x(e){var t;let{onFileSelect:r,accept:l=".xlsx,.xls",maxSize:n=10,disabled:x=!1}=e,[p,g]=(0,s.useState)(!1),[f,v]=(0,s.useState)(null),[j,b]=(0,s.useState)(null),N=(0,s.useCallback)(e=>{var t;let r=l.split(",").map(e=>e.trim().toLowerCase()),a="."+(null==(t=e.name.split(".").pop())?void 0:t.toLowerCase());return r.includes(a)?e.size>1024*n*1024?"File size exceeds ".concat(n,"MB limit."):null:"Invalid file type. Please upload ".concat(l," files.")},[l,n]),y=(0,s.useCallback)(e=>{let t=N(e);if(t)return void b(t);b(null),v(e),r(e)},[N,r]),w=(0,s.useCallback)(e=>{if(e.preventDefault(),g(!1),x)return;let t=e.dataTransfer.files[0];t&&y(t)},[x,y]),k=(0,s.useCallback)(e=>{e.preventDefault(),x||g(!0)},[x]),A=(0,s.useCallback)(e=>{e.preventDefault(),g(!1)},[]),C=(0,s.useCallback)(e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];r&&y(r)},[y]),D=(0,s.useCallback)(()=>{v(null),b(null)},[]);return(0,a.jsxs)("div",{className:"space-y-4",children:[j&&(0,a.jsxs)(h.Fc,{variant:"destructive",children:[(0,a.jsx)(d.A,{className:"h-4 w-4"}),(0,a.jsx)(h.TN,{children:j})]}),f?(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-border bg-muted/50 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(c.A,{className:"h-10 w-10 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:f.name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:(t=f.size)<1024?t+" B":t<1048576?(t/1024).toFixed(1)+" KB":(t/1048576).toFixed(1)+" MB"})]})]}),(0,a.jsx)(m.$,{variant:"ghost",size:"icon",onClick:D,disabled:x,children:(0,a.jsx)(o.A,{className:"h-4 w-4"})})]}):(0,a.jsxs)("div",{onDrop:w,onDragOver:k,onDragLeave:A,className:(0,i.cn)("relative rounded-lg border-2 border-dashed p-8 text-center transition-colors",p?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-muted-foreground/50",x&&"cursor-not-allowed opacity-50"),children:[(0,a.jsx)("input",{type:"file",accept:l,onChange:C,disabled:x,className:"absolute inset-0 cursor-pointer opacity-0"}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)("div",{className:"rounded-full bg-muted p-3",children:(0,a.jsx)(u.A,{className:"h-6 w-6 text-muted-foreground"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:["Drop your Excel file here, or"," ",(0,a.jsx)("span",{className:"text-primary",children:"browse"})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Supports ",l," files up to ",n,"MB"]})]})]})]})]})}var p=r(11186);function g(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,i.cn)("w-full caption-bottom text-sm",t),...r})})}function f(e){let{className:t,...r}=e;return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,i.cn)("[&_tr]:border-b",t),...r})}function v(e){let{className:t,...r}=e;return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,i.cn)("[&_tr:last-child]:border-0",t),...r})}function j(e){let{className:t,...r}=e;return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,i.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...r})}function b(e){let{className:t,...r}=e;return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,i.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r})}function N(e){let{className:t,...r}=e;return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,i.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r})}var y=r(11647),w=r(5917),k=r(26667),A=r(17037);let C=[{key:"email",label:"Email",required:!0,group:"Basic Info"},{key:"firstName",label:"First Name",required:!0,group:"Basic Info"},{key:"lastName",label:"Last Name",required:!0,group:"Basic Info"},{key:"axisEmail",label:"Axis Email",required:!1,group:"Basic Info"},{key:"reportingLevel1",label:"Reporting Level 1",required:!1,group:"Organization"},{key:"reportingLevel2",label:"Reporting Level 2",required:!1,group:"Organization"},{key:"reportingLevel3",label:"Reporting Level 3",required:!1,group:"Organization"},{key:"function",label:"Function",required:!1,group:"Organization"},{key:"location",label:"Location",required:!1,group:"Organization"},{key:"arrivalDate",label:"Arrival Date",required:!1,group:"Flight - Arrival"},{key:"arrivalTime",label:"Arrival Time",required:!1,group:"Flight - Arrival"},{key:"arrivalFlightNumber",label:"Arrival Flight Number",required:!1,group:"Flight - Arrival"},{key:"arrivalAirport",label:"Arrival Airport",required:!1,group:"Flight - Arrival"},{key:"arrivalFlightRoute",label:"Arrival Flight Route",required:!1,group:"Flight - Arrival"},{key:"departureDate",label:"Departure Date",required:!1,group:"Flight - Departure"},{key:"departureTime",label:"Departure Time",required:!1,group:"Flight - Departure"},{key:"departureFlightNumber",label:"Departure Flight Number",required:!1,group:"Flight - Departure"},{key:"departureAirport",label:"Departure Airport",required:!1,group:"Flight - Departure"},{key:"departureFlightRoute",label:"Departure Flight Route",required:!1,group:"Flight - Departure"},{key:"hotelCheckinDate",label:"Hotel Check-in Date",required:!1,group:"Hotel"},{key:"hotelCheckoutDate",label:"Hotel Check-out Date",required:!1,group:"Hotel"},{key:"extendStayBefore",label:"Extend Stay Before",required:!1,group:"Hotel"},{key:"extendStayAfter",label:"Extend Stay After",required:!1,group:"Hotel"},{key:"earlyCheckin",label:"Early Check-in",required:!1,group:"Hotel"},{key:"lateCheckout",label:"Late Check-out",required:!1,group:"Hotel"},{key:"needsArrivalTransfer",label:"Needs Arrival Transfer",required:!1,group:"Transport"},{key:"needsDepartureTransfer",label:"Needs Departure Transfer",required:!1,group:"Transport"},{key:"registrationStatus",label:"Registration Status",required:!1,group:"Status"},{key:"travelType",label:"Travel Type",required:!1,group:"Status"}],D={email:["email","e-mail","email address","e-mail address"],firstName:["first name","firstname","given name","first"],lastName:["last name","lastname","family name","surname","last"],axisEmail:["axis email","work email","corporate email"],reportingLevel1:["reporting level 1","level 1","department","org level 1"],reportingLevel2:["reporting level 2","level 2","team","org level 2"],reportingLevel3:["reporting level 3","level 3","sub-team","org level 3"],function:["function","role","job function"],location:["location","office","city","country"],arrivalDate:["arrival date","arriving","flight arrival date","arrival"],arrivalTime:["arrival time","arrival flight time","arriving time"],arrivalFlightNumber:["arrival flight","flight number","arrival flight number","flight in"],arrivalAirport:["arrival airport","arriving airport"],departureDate:["departure date","departing","flight departure date","departure"],departureTime:["departure time","departure flight time","departing time"],departureFlightNumber:["departure flight","departure flight number","flight out"],departureAirport:["departure airport","departing airport"],hotelCheckinDate:["check-in date","checkin date","hotel check-in","check in"],hotelCheckoutDate:["check-out date","checkout date","hotel check-out","check out"],needsArrivalTransfer:["arrival transfer","airport transfer arrival","need arrival transfer"],needsDepartureTransfer:["departure transfer","airport transfer departure","need departure transfer"],registrationStatus:["status","registration status","reg status"],travelType:["travel type","travel","type"]};function F(e){let{excelColumns:t,sampleData:r,mapping:l,onMappingChange:i}=e,[n,d]=(0,s.useState)(!0),c=C.filter(e=>e.required),u=c.filter(e=>Object.values(l).includes(e.key)),h=c.filter(e=>!Object.values(l).includes(e.key)),x=(0,s.useMemo)(()=>{let e={};return C.forEach(t=>{e[t.group]||(e[t.group]=[]),e[t.group].push(t)}),e},[]);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 rounded-lg border bg-muted/50 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[0===h.length?(0,a.jsx)(w.A,{className:"h-5 w-5 text-green-600"}):(0,a.jsx)(o.A,{className:"h-5 w-5 text-red-600"}),(0,a.jsxs)("span",{className:"text-sm",children:[u.length,"/",c.length," required fields mapped"]})]}),h.length>0&&(0,a.jsx)("div",{className:"flex gap-1",children:h.map(e=>(0,a.jsx)(y.E,{variant:"destructive",className:"text-xs",children:e.label},e.key))})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(m.$,{variant:"outline",size:"sm",onClick:()=>{let e={};t.forEach(t=>{e[t]=null}),i(e)},children:"Clear All"}),(0,a.jsxs)(m.$,{variant:"outline",size:"sm",onClick:()=>{let e={};t.forEach(t=>{let r=t.toLowerCase().trim();for(let[a,s]of Object.entries(D))if(s.some(e=>r.includes(e)||e.includes(r))&&!Object.values(e).includes(a)){e[t]=a;break}t in e||(e[t]=null)}),i(e)},children:[(0,a.jsx)(k.A,{className:"mr-2 h-4 w-4"}),"Auto-Map"]})]})]}),(0,a.jsx)("div",{className:"rounded-lg border",children:(0,a.jsxs)(g,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(j,{children:[(0,a.jsx)(b,{className:"w-1/3",children:"Excel Column"}),(0,a.jsx)(b,{className:"w-1/3",children:"Map To"}),(0,a.jsx)(b,{className:"w-1/3",children:"Sample Value"})]})}),(0,a.jsx)(v,{children:t.map(e=>{var t;return(0,a.jsxs)(j,{children:[(0,a.jsx)(N,{className:"font-medium",children:e}),(0,a.jsx)(N,{children:(0,a.jsxs)(p.l6,{value:l[e]||"unmapped",onValueChange:t=>((e,t)=>{if(t){var r;let a=null==(r=Object.entries(l).find(e=>{let[,r]=e;return r===t}))?void 0:r[0];if(a&&a!==e)return void i({...l,[a]:null,[e]:t})}i({...l,[e]:t})})(e,"unmapped"===t?null:t),children:[(0,a.jsx)(p.bq,{className:"w-full",children:(0,a.jsx)(p.yv,{placeholder:"Select field..."})}),(0,a.jsxs)(p.gC,{children:[(0,a.jsx)(p.eb,{value:"unmapped",children:(0,a.jsx)("span",{className:"text-muted-foreground",children:"-- Don't import --"})}),Object.entries(x).map(t=>{let[r,s]=t;return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground",children:r}),s.map(t=>{let r=Object.values(l).includes(t.key)&&l[e]!==t.key;return(0,a.jsx)(p.eb,{value:t.key,disabled:r,children:(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[t.label,t.required&&(0,a.jsx)("span",{className:"text-red-500",children:"*"}),r&&(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"(already mapped)"})]})},t.key)})]},r)})]})]})}),(0,a.jsx)(N,{className:"text-sm text-muted-foreground",children:(null==(t=r[0])?void 0:t[e])!==void 0?String(r[0][e]).slice(0,50):"-"})]},e)})})]})}),n&&r.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"Data Preview (first 3 rows)"}),(0,a.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>d(!1),children:"Hide Preview"})]}),(0,a.jsx)(A.F,{className:"rounded-lg border",children:(0,a.jsx)("div",{className:"max-h-64",children:(0,a.jsxs)(g,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(j,{children:[t.slice(0,8).map(e=>(0,a.jsx)(b,{className:"whitespace-nowrap",children:e},e)),t.length>8&&(0,a.jsxs)(b,{children:["+",t.length-8," more"]})]})}),(0,a.jsx)(v,{children:r.slice(0,3).map((e,r)=>(0,a.jsxs)(j,{children:[t.slice(0,8).map(t=>(0,a.jsx)(N,{className:"max-w-32 truncate text-sm",children:void 0!==e[t]?String(e[t]):"-"},t)),t.length>8&&(0,a.jsx)(N,{children:"..."})]},r))})]})})})]})]})}var S=r(86602);function E(e){let{className:t,...r}=e;return(0,a.jsx)(S.bL,{"data-slot":"checkbox",className:(0,i.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:(0,a.jsx)(S.C1,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current transition-none",children:(0,a.jsx)(w.A,{className:"size-3.5"})})})}var L=r(94653);let T=L.bL,z=L.R6,R=L.Ke;var q=r(13406),_=r(52987),O=r(24033),B=r(27937),M=r(71360),I=r(52056),$=r(23327),X=r(6191),H=r(18514),V=r(17910),P=r(70532),U=r(57828);let G={email:"Email",firstName:"First Name",lastName:"Last Name",axisEmail:"Axis Email",reportingLevel1:"Reporting Level 1",reportingLevel2:"Reporting Level 2",reportingLevel3:"Reporting Level 3",function:"Function",location:"Location",arrivalDate:"Arrival Date",arrivalTime:"Arrival Time",arrivalFlightNumber:"Arrival Flight",arrivalAirport:"Arrival Airport",arrivalFlightRoute:"Arrival Route",departureDate:"Departure Date",departureTime:"Departure Time",departureFlightNumber:"Departure Flight",departureAirport:"Departure Airport",departureFlightRoute:"Departure Route",hotelCheckinDate:"Hotel Check-in",hotelCheckoutDate:"Hotel Check-out",extendStayBefore:"Extend Before",extendStayAfter:"Extend After",earlyCheckin:"Early Check-in",lateCheckout:"Late Check-out",needsArrivalTransfer:"Arrival Transfer",needsDepartureTransfer:"Departure Transfer",registrationStatus:"Status",travelType:"Travel Type"};function W(e){return null==e?"(empty)":"boolean"==typeof e?e?"Yes":"No":e instanceof Date?e.toLocaleDateString():String(e)}function Z(e){let{change:t}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsxs)("span",{className:"font-medium text-muted-foreground",children:[G[t.field]||t.field,":"]}),(0,a.jsx)("span",{className:"rounded bg-red-100 px-1.5 py-0.5 text-red-800 line-through",children:W(t.oldValue)}),(0,a.jsx)(_.A,{className:"h-3 w-3 text-muted-foreground"}),(0,a.jsx)("span",{className:"rounded bg-green-100 px-1.5 py-0.5 text-green-800",children:W(t.newValue)})]})}function K(e){let{guest:t,changes:r}=e,[l,i]=(0,s.useState)(!1);return(0,a.jsxs)(T,{open:l,onOpenChange:i,children:[(0,a.jsx)(z,{asChild:!0,children:(0,a.jsxs)(j,{className:"cursor-pointer hover:bg-amber-50",children:[(0,a.jsx)(N,{children:l?(0,a.jsx)(O.A,{className:"h-4 w-4"}):(0,a.jsx)(B.A,{className:"h-4 w-4"})}),(0,a.jsx)(N,{children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"font-medium",children:[t.firstName," ",t.lastName]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:t.email})]})}),(0,a.jsx)(N,{children:(0,a.jsxs)(y.E,{variant:"outline",className:"bg-amber-100 text-amber-800",children:[r.length," change",1!==r.length?"s":""]})})]})}),(0,a.jsx)(R,{asChild:!0,children:(0,a.jsx)(j,{className:"bg-amber-50/50",children:(0,a.jsx)(N,{colSpan:3,className:"p-4",children:(0,a.jsx)("div",{className:"space-y-2",children:r.map((e,t)=>(0,a.jsx)(Z,{change:e},t))})})})})]})}function Y(e){let{guest:t}=e,[r,l]=(0,s.useState)(!1);return(0,a.jsxs)(T,{open:r,onOpenChange:l,children:[(0,a.jsx)(z,{asChild:!0,children:(0,a.jsxs)(j,{className:"cursor-pointer hover:bg-green-50",children:[(0,a.jsx)(N,{children:r?(0,a.jsx)(O.A,{className:"h-4 w-4"}):(0,a.jsx)(B.A,{className:"h-4 w-4"})}),(0,a.jsx)(N,{children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"font-medium",children:[t.firstName," ",t.lastName]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:t.email})]})}),(0,a.jsx)(N,{children:(0,a.jsx)(y.E,{className:"bg-green-100 text-green-800",children:"New"})})]})}),(0,a.jsx)(R,{asChild:!0,children:(0,a.jsx)(j,{className:"bg-green-50/50",children:(0,a.jsx)(N,{colSpan:3,className:"p-4",children:(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:Object.entries(t).filter(e=>{let[t,r]=e;return null!=r&&"id"!==t&&"createdAt"!==t&&"updatedAt"!==t}).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("span",{className:"font-medium text-muted-foreground",children:[G[t]||t,":"]}),(0,a.jsx)("span",{children:W(r)})]},t)})})})})})]})}function Q(e){let{guest:t}=e;return(0,a.jsxs)(j,{className:"bg-red-50/50",children:[(0,a.jsx)(N,{children:(0,a.jsx)(M.A,{className:"h-4 w-4 text-red-500"})}),(0,a.jsx)(N,{children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"font-medium",children:[t.firstName," ",t.lastName]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:t.email})]})}),(0,a.jsx)(N,{children:(0,a.jsx)(y.E,{variant:"destructive",children:"Not in import"})})]})}function J(e){let{row:t,errors:r}=e;return(0,a.jsxs)(j,{className:"bg-red-50",children:[(0,a.jsx)(N,{children:(0,a.jsx)(d.A,{className:"h-4 w-4 text-red-500"})}),(0,a.jsxs)(N,{children:["Row ",t]}),(0,a.jsx)(N,{children:(0,a.jsx)("div",{className:"space-y-1",children:r.map((e,t)=>(0,a.jsx)("p",{className:"text-sm text-red-600",children:e},t))})})]})}function ee(e){let{type:t}=e;switch(t){case"error":return(0,a.jsx)(d.A,{className:"h-4 w-4 text-red-600"});case"warning":return(0,a.jsx)(I.A,{className:"h-4 w-4 text-amber-600"});case"info":return(0,a.jsx)($.A,{className:"h-4 w-4 text-blue-600"})}}function et(e){let{diff:t,onApprove:r,onCancel:l,isApplying:n=!1}=e,[c,o]=(0,s.useState)("all"),[u,x]=(0,s.useState)(!1),[p,y]=(0,s.useState)(!1),[w,k]=(0,s.useState)(!0),C=(0,s.useMemo)(()=>({added:t.added.length,modified:t.modified.length,removed:t.removed.length,unchanged:t.unchanged.length,errors:t.errors.length,total:t.added.length+t.modified.length+t.removed.length+t.unchanged.length}),[t]),D=(0,s.useMemo)(()=>(function(e){let t=[];[...e.added,...e.modified.map(e=>e.existing)],e.added.length>50&&t.push({type:"warning",title:"Large Import Batch",description:"Adding ".concat(e.added.length," new guests at once. Consider reviewing in smaller batches."),count:e.added.length}),e.removed.length>10&&e.removed.length>e.added.length&&t.push({type:"warning",title:"High Removal Rate",description:"".concat(e.removed.length," guests will be removed. This is more than the ").concat(e.added.length," being added."),count:e.removed.length});let r=[];[...e.added,...e.modified.map(e=>({...e.existing,...Object.fromEntries(e.changes.map(e=>[e.field,e.newValue]))}))].forEach(e=>{let t=e.arrivalDate,a=e.departureDate,s="".concat(e.firstName," ").concat(e.lastName);t&&a&&new Date(t)>new Date(a)&&r.push("".concat(s,": Arrival after departure"))}),r.length>0&&t.push({type:"error",title:"Date Inconsistencies",description:"".concat(r.length," guest(s) have arrival dates after departure dates."),count:r.length,items:r.slice(0,5)});let a=[];[...e.added].forEach(e=>{let t="".concat(e.firstName," ").concat(e.lastName);e.needsArrivalTransfer&&!e.arrivalFlightNumber&&a.push("".concat(t,": Needs arrival transfer but no flight")),e.needsDepartureTransfer&&!e.departureFlightNumber&&a.push("".concat(t,": Needs departure transfer but no flight"))}),a.length>0&&t.push({type:"warning",title:"Missing Flight Information",description:"".concat(a.length," guest(s) need transfer but have no flight info."),count:a.length,items:a.slice(0,5)});let s=new Map;[...e.added,...e.unchanged].forEach(e=>{let t="".concat(e.firstName," ").concat(e.lastName).toLowerCase();s.set(t,(s.get(t)||0)+1)});let l=Array.from(s.entries()).filter(e=>{let[,t]=e;return t>1}).map(e=>{let[t]=e;return t});l.length>0&&t.push({type:"info",title:"Potential Duplicate Names",description:"".concat(l.length," name(s) appear multiple times. Verify these are different people."),count:l.length,items:l.slice(0,5)});let i=[],n=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;e.added.forEach(e=>{e.email&&!n.test(e.email)&&i.push("".concat(e.firstName," ").concat(e.lastName,": ").concat(e.email))}),i.length>0&&t.push({type:"error",title:"Invalid Email Format",description:"".concat(i.length," guest(s) have invalid email addresses."),count:i.length,items:i.slice(0,5)});let d=[];e.modified.forEach(e=>{let{existing:t,changes:r}=e,a="".concat(t.firstName," ").concat(t.lastName),s=["email","arrivalDate","departureDate","arrivalFlightNumber","departureFlightNumber"];r.some(e=>s.includes(e.field))&&d.push(a)}),d.length>0&&t.push({type:"info",title:"Critical Field Updates",description:"".concat(d.length," guest(s) have changes to important fields (dates, flights, email)."),count:d.length,items:d.slice(0,5)});let c=[];return e.added.forEach(e=>{e.arrivalDate&&e.departureDate&&e.arrivalDate===e.departureDate&&c.push("".concat(e.firstName," ").concat(e.lastName))}),c.length>0&&t.push({type:"info",title:"Same-Day Trips",description:"".concat(c.length," guest(s) arrive and depart on the same day."),count:c.length,items:c.slice(0,5)}),t})(t),[t]),F=D.filter(e=>"error"===e.type),S=D.filter(e=>"warning"===e.type),L=D.filter(e=>"info"===e.type),T=C.added>0||C.modified>0;return C.removed>0||C.errors,(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-5",children:[(0,a.jsxs)("div",{className:(0,i.cn)("rounded-lg border p-4 text-center",C.added>0&&"border-green-200 bg-green-50"),children:[(0,a.jsx)(X.A,{className:"mx-auto h-5 w-5 text-green-600"}),(0,a.jsx)("p",{className:"mt-1 text-2xl font-bold text-green-600",children:C.added}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"New"})]}),(0,a.jsxs)("div",{className:(0,i.cn)("rounded-lg border p-4 text-center",C.modified>0&&"border-amber-200 bg-amber-50"),children:[(0,a.jsx)(H.A,{className:"mx-auto h-5 w-5 text-amber-600"}),(0,a.jsx)("p",{className:"mt-1 text-2xl font-bold text-amber-600",children:C.modified}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Modified"})]}),(0,a.jsxs)("div",{className:(0,i.cn)("rounded-lg border p-4 text-center",C.removed>0&&"border-red-200 bg-red-50"),children:[(0,a.jsx)(M.A,{className:"mx-auto h-5 w-5 text-red-600"}),(0,a.jsx)("p",{className:"mt-1 text-2xl font-bold text-red-600",children:C.removed}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Removed"})]}),(0,a.jsxs)("div",{className:"rounded-lg border p-4 text-center",children:[(0,a.jsx)("p",{className:"mt-1 text-2xl font-bold text-muted-foreground",children:C.unchanged}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Unchanged"})]}),(0,a.jsxs)("div",{className:(0,i.cn)("rounded-lg border p-4 text-center",C.errors>0&&"border-red-200 bg-red-50"),children:[(0,a.jsx)(d.A,{className:"mx-auto h-5 w-5 text-red-600"}),(0,a.jsx)("p",{className:"mt-1 text-2xl font-bold text-red-600",children:C.errors}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Errors"})]})]}),D.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"flex items-center gap-2 text-sm font-semibold",children:[(0,a.jsx)(V.A,{className:"h-4 w-4"}),"Import Analysis (",D.length," alert",1!==D.length?"s":"",")"]}),(0,a.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>k(!w),children:w?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.A,{className:"mr-1 h-4 w-4"}),"Hide"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(U.A,{className:"mr-1 h-4 w-4"}),"Show"]})})]}),w&&(0,a.jsxs)("div",{className:"space-y-2",children:[F.map((e,t)=>(0,a.jsxs)(h.Fc,{variant:"destructive",className:"border-red-200 bg-red-50",children:[(0,a.jsx)(ee,{type:"error"}),(0,a.jsx)(h.XL,{className:"text-red-800",children:e.title}),(0,a.jsxs)(h.TN,{className:"text-red-700",children:[(0,a.jsx)("p",{children:e.description}),e.items&&e.items.length>0&&(0,a.jsxs)("ul",{className:"mt-2 list-inside list-disc text-sm",children:[e.items.map((e,t)=>(0,a.jsx)("li",{children:e},t)),e.count&&e.count>5&&(0,a.jsxs)("li",{className:"text-red-500",children:["...and ",e.count-5," more"]})]})]})]},"error-".concat(t))),S.map((e,t)=>(0,a.jsxs)(h.Fc,{className:"border-amber-200 bg-amber-50",children:[(0,a.jsx)(ee,{type:"warning"}),(0,a.jsx)(h.XL,{className:"text-amber-800",children:e.title}),(0,a.jsxs)(h.TN,{className:"text-amber-700",children:[(0,a.jsx)("p",{children:e.description}),e.items&&e.items.length>0&&(0,a.jsxs)("ul",{className:"mt-2 list-inside list-disc text-sm",children:[e.items.map((e,t)=>(0,a.jsx)("li",{children:e},t)),e.count&&e.count>5&&(0,a.jsxs)("li",{className:"text-amber-500",children:["...and ",e.count-5," more"]})]})]})]},"warning-".concat(t))),L.map((e,t)=>(0,a.jsxs)(h.Fc,{className:"border-blue-200 bg-blue-50",children:[(0,a.jsx)(ee,{type:"info"}),(0,a.jsx)(h.XL,{className:"text-blue-800",children:e.title}),(0,a.jsxs)(h.TN,{className:"text-blue-700",children:[(0,a.jsx)("p",{children:e.description}),e.items&&e.items.length>0&&(0,a.jsxs)("ul",{className:"mt-2 list-inside list-disc text-sm",children:[e.items.map((e,t)=>(0,a.jsx)("li",{children:e},t)),e.count&&e.count>5&&(0,a.jsxs)("li",{className:"text-blue-500",children:["...and ",e.count-5," more"]})]})]})]},"info-".concat(t)))]})]}),(0,a.jsxs)(q.tU,{value:c,onValueChange:o,children:[(0,a.jsxs)(q.j7,{children:[(0,a.jsxs)(q.Xi,{value:"all",children:["All Changes (",C.added+C.modified,")"]}),(0,a.jsxs)(q.Xi,{value:"added",disabled:0===C.added,children:["Added (",C.added,")"]}),(0,a.jsxs)(q.Xi,{value:"modified",disabled:0===C.modified,children:["Modified (",C.modified,")"]}),(0,a.jsxs)(q.Xi,{value:"removed",disabled:0===C.removed,children:["Removed (",C.removed,")"]}),(0,a.jsxs)(q.Xi,{value:"errors",disabled:0===C.errors,children:["Errors (",C.errors,")"]})]}),(0,a.jsxs)(A.F,{className:"mt-4 h-[400px] rounded-lg border",children:[(0,a.jsx)(q.av,{value:"all",className:"m-0",children:(0,a.jsxs)(g,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(j,{children:[(0,a.jsx)(b,{className:"w-10"}),(0,a.jsx)(b,{children:"Guest"}),(0,a.jsx)(b,{className:"w-32",children:"Status"})]})}),(0,a.jsxs)(v,{children:[t.added.map((e,t)=>(0,a.jsx)(Y,{guest:e},"added-".concat(t))),t.modified.map((e,t)=>{let{existing:r,changes:s}=e;return(0,a.jsx)(K,{guest:r,changes:s},"modified-".concat(t))}),0===t.added.length&&0===t.modified.length&&(0,a.jsx)(j,{children:(0,a.jsx)(N,{colSpan:3,className:"py-8 text-center text-muted-foreground",children:"No changes to apply"})})]})]})}),(0,a.jsx)(q.av,{value:"added",className:"m-0",children:(0,a.jsxs)(g,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(j,{children:[(0,a.jsx)(b,{className:"w-10"}),(0,a.jsx)(b,{children:"Guest"}),(0,a.jsx)(b,{className:"w-32",children:"Status"})]})}),(0,a.jsx)(v,{children:t.added.map((e,t)=>(0,a.jsx)(Y,{guest:e},t))})]})}),(0,a.jsx)(q.av,{value:"modified",className:"m-0",children:(0,a.jsxs)(g,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(j,{children:[(0,a.jsx)(b,{className:"w-10"}),(0,a.jsx)(b,{children:"Guest"}),(0,a.jsx)(b,{className:"w-32",children:"Changes"})]})}),(0,a.jsx)(v,{children:t.modified.map((e,t)=>{let{existing:r,changes:s}=e;return(0,a.jsx)(K,{guest:r,changes:s},t)})})]})}),(0,a.jsx)(q.av,{value:"removed",className:"m-0",children:(0,a.jsxs)(g,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(j,{children:[(0,a.jsx)(b,{className:"w-10"}),(0,a.jsx)(b,{children:"Guest"}),(0,a.jsx)(b,{className:"w-32",children:"Status"})]})}),(0,a.jsx)(v,{children:t.removed.map((e,t)=>(0,a.jsx)(Q,{guest:e},t))})]})}),(0,a.jsx)(q.av,{value:"errors",className:"m-0",children:(0,a.jsxs)(g,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(j,{children:[(0,a.jsx)(b,{className:"w-10"}),(0,a.jsx)(b,{children:"Row"}),(0,a.jsx)(b,{children:"Errors"})]})}),(0,a.jsx)(v,{children:t.errors.map((e,t)=>(0,a.jsx)(J,{row:e.row,errors:e.errors},t))})]})})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)(m.$,{variant:"ghost",size:"sm",onClick:()=>y(!p),children:[p?(0,a.jsx)(P.A,{className:"mr-2 h-4 w-4"}):(0,a.jsx)(U.A,{className:"mr-2 h-4 w-4"}),p?"Hide":"Show"," ",C.unchanged," unchanged guests"]})}),p&&(0,a.jsx)(A.F,{className:"h-48 rounded-lg border",children:(0,a.jsx)(g,{children:(0,a.jsx)(v,{children:t.unchanged.map((e,t)=>(0,a.jsxs)(j,{children:[(0,a.jsxs)(N,{children:[e.firstName," ",e.lastName]}),(0,a.jsx)(N,{className:"text-muted-foreground",children:e.email})]},t))})})}),C.removed>0&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 rounded-lg border border-red-200 bg-red-50 p-4",children:[(0,a.jsx)(E,{id:"removeDeleted",checked:u,onCheckedChange:e=>x(!0===e)}),(0,a.jsxs)("label",{htmlFor:"removeDeleted",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:["Also remove ",C.removed," guest",1!==C.removed?"s":""," ","not found in this import (soft delete)"]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)(m.$,{variant:"outline",onClick:l,disabled:n,children:"Cancel"}),(0,a.jsx)(m.$,{onClick:()=>r({removeDeleted:u}),disabled:!T||n,children:n?"Applying...":"Apply ".concat(C.added+C.modified," Changes")})]})]})}var er=r(86948),ea=r(9484);function es(e){let{className:t,value:r,...s}=e;return(0,a.jsx)(ea.bL,{"data-slot":"progress",className:(0,i.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",t),...s,children:(0,a.jsx)(ea.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})}var el=r(4246),ei=r(23183),en=r(18720),ed=r(35626),ec=r(35299);let eo=[{key:"upload",label:"Upload",description:"Select Excel file"},{key:"mapping",label:"Map Columns",description:"Match columns to fields"},{key:"preview",label:"Review",description:"Review changes before import"},{key:"complete",label:"Complete",description:"Import finished"}];function eu(){var e;let t=(0,l.useRouter)(),[r,i]=(0,s.useState)("upload"),[o,p]=(0,s.useState)(null),[g,f]=(0,s.useState)([]),[v,j]=(0,s.useState)([]),[b,N]=(0,s.useState)({}),[y,k]=(0,s.useState)(null),[A,C]=(0,s.useState)(null),[D,S]=(0,s.useState)(!1),[E,L]=(0,s.useState)(null),T=ei.i.import.preview.useMutation(),z=ei.i.import.executeImport.useMutation({onError:e=>{console.error("Execute import mutation error:",e)}}),R=eo.findIndex(e=>e.key===r),q=(R+1)/eo.length*100,O=(0,s.useCallback)(async e=>{p(e),L(null),S(!0);try{let t=await new Promise((t,r)=>{let a=new FileReader;a.onload=e=>{try{var a;let s=new Uint8Array(null==(a=e.target)?void 0:a.result),l=el.LF(s,{type:"array",cellDates:!0}),i=l.SheetNames[0],n=l.Sheets[i],d=el.Wp.sheet_to_json(n,{defval:null,raw:!1});if(0===d.length)return void r(Error("No data found in Excel file"));let c=Object.keys(d[0]);t({columns:c,data:d,sheetName:i})}catch(e){r(Error("Failed to parse Excel file: "+String(e)))}},a.onerror=()=>{r(Error("Failed to read file"))},a.readAsArrayBuffer(e)});f(t.columns),j(t.data);let r={};t.columns.forEach(e=>{r[e]=null}),N(r),en.oR.success("Loaded ".concat(t.data.length,' rows from "').concat(t.sheetName,'"'))}catch(e){L(String(e)),en.oR.error("Failed to parse Excel file")}finally{S(!1)}},[]),B=(0,s.useCallback)(async()=>{if("upload"===r){if(!o||0===v.length)return void en.oR.error("Please select a valid Excel file");i("mapping")}else if("mapping"===r){let e=Object.values(b).filter(Boolean),t=["email","firstName","lastName"].filter(t=>!e.includes(t));if(t.length>0)return void en.oR.error("Please map required fields: ".concat(t.join(", ")));S(!0),L(null);try{let e=v.map(e=>{let t={};for(let[r,a]of Object.entries(b))if(a&&void 0!==e[r]){let s=e[r];a.includes("Date")?s=function(e){if(null==e||""===e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];let t=String(e).trim();if(/^\d{4}-\d{2}-\d{2}/.test(t))return t.split("T")[0];let r=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(r){let[,e,t,a]=r;return"".concat(a,"-").concat(t.padStart(2,"0"),"-").concat(e.padStart(2,"0"))}let a=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(a){let[,e,t,r]=a;return"".concat(r,"-").concat(e.padStart(2,"0"),"-").concat(t.padStart(2,"0"))}return null}(s):a.includes("Time")?s=function(e){if(null==e||""===e)return null;let t=String(e).trim().match(/^(\d{1,2}):(\d{2})(?::(\d{2}))?/);if(t){let[,e,r]=t;return"".concat(e.padStart(2,"0"),":").concat(r)}return null}(s):a.startsWith("needs")||a.startsWith("extend")||"isDuplicate"===a||"isRemoved"===a?s=function(e){if(null==e||""===e)return null;let t=String(e).toLowerCase().trim();return!!["yes","true","1","y"].includes(t)||!["no","false","0","n"].includes(t)&&null}(s):"string"==typeof s&&(s=s.trim()),t[a]=s}return t}),t=await T.mutateAsync({data:e,columnMapping:b,filename:o.name});k(t.diff),C(t.sessionId),i("preview"),en.oR.success("Found ".concat(t.summary.added," new, ").concat(t.summary.modified," modified, ").concat(t.summary.removed," removed"))}catch(e){L(String(e)),en.oR.error("Failed to process import")}finally{S(!1)}}},[r,o,v,b,T]),M=(0,s.useCallback)(()=>{"mapping"===r?i("upload"):"preview"===r&&i("mapping")},[r]),I=(0,s.useCallback)(async e=>{if(y&&A){S(!0),L(null);try{await z.mutateAsync({sessionId:A,diff:{added:y.added,modified:y.modified,removed:y.removed},removeDeleted:e.removeDeleted}),i("complete"),en.oR.success("Import completed successfully!")}catch(e){L(String(e)),en.oR.error("Failed to apply import")}finally{S(!1)}}},[y,A,z]),$=(0,s.useCallback)(()=>{t.push("/guests")},[t]);return(0,a.jsxs)("div",{className:"mx-auto max-w-4xl",children:[(0,a.jsx)(n,{title:"Import Guest Data",description:"Upload an Excel file to import or update guest information"}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("div",{className:"mb-2 flex justify-between text-sm",children:eo.map((e,t)=>(0,a.jsx)("div",{className:"flex-1 text-center ".concat(t<=R?"text-primary":"text-muted-foreground"),children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[t<R?(0,a.jsx)(w.A,{className:"h-4 w-4"}):(0,a.jsx)("span",{className:"flex h-5 w-5 items-center justify-center rounded-full border text-xs",children:t+1}),(0,a.jsx)("span",{className:"hidden sm:inline",children:e.label})]})},e.key))}),(0,a.jsx)(es,{value:q,className:"h-2"})]}),E&&(0,a.jsxs)(h.Fc,{variant:"destructive",className:"mb-6",children:[(0,a.jsx)(d.A,{className:"h-4 w-4"}),(0,a.jsx)(h.XL,{children:"Error"}),(0,a.jsx)(h.TN,{children:E})]}),(0,a.jsxs)(er.Zp,{children:[(0,a.jsx)(er.aR,{children:(0,a.jsxs)(er.ZB,{className:"flex items-center gap-2",children:["upload"===r&&(0,a.jsx)(u.A,{className:"h-5 w-5"}),"mapping"===r&&(0,a.jsx)(c.A,{className:"h-5 w-5"}),"preview"===r&&(0,a.jsx)(w.A,{className:"h-5 w-5"}),null==(e=eo.find(e=>e.key===r))?void 0:e.description]})}),(0,a.jsxs)(er.Wu,{children:["upload"===r&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(x,{onFileSelect:O,disabled:D}),o&&v.length>0&&(0,a.jsxs)(h.Fc,{children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),(0,a.jsx)(h.XL,{children:"File loaded successfully"}),(0,a.jsxs)(h.TN,{children:["Found ",g.length," columns and ",v.length," rows. Click Next to map columns to guest fields."]})]})]}),"mapping"===r&&(0,a.jsx)(F,{excelColumns:g,sampleData:v.slice(0,3),mapping:b,onMappingChange:N}),"preview"===r&&y&&(0,a.jsx)(et,{diff:y,onApprove:I,onCancel:$,isApplying:D}),"complete"===r&&(0,a.jsxs)("div",{className:"py-8 text-center",children:[(0,a.jsx)("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-green-100",children:(0,a.jsx)(w.A,{className:"h-8 w-8 text-green-600"})}),(0,a.jsx)("h3",{className:"mb-2 text-lg font-semibold",children:"Import Complete!"}),(0,a.jsx)("p",{className:"mb-6 text-muted-foreground",children:"Guest data has been successfully imported."}),(0,a.jsxs)("div",{className:"flex justify-center gap-3",children:[(0,a.jsx)(m.$,{variant:"outline",onClick:()=>t.push("/guests"),children:"View Guests"}),(0,a.jsx)(m.$,{onClick:()=>t.push("/audit"),children:"View Audit Log"})]})]})]})]}),("upload"===r||"mapping"===r)&&(0,a.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,a.jsxs)(m.$,{variant:"outline",onClick:"upload"===r?$:M,disabled:D,children:[(0,a.jsx)(ed.A,{className:"mr-2 h-4 w-4"}),"upload"===r?"Cancel":"Back"]}),(0,a.jsx)(m.$,{onClick:B,disabled:D||!o,children:D?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ec.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:["Next",(0,a.jsx)(_.A,{className:"ml-2 h-4 w-4"})]})})]})]})}},13406:(e,t,r)=>{"use strict";r.d(t,{Xi:()=>d,av:()=>c,j7:()=>n,tU:()=>i});var a=r(95155);r(12115);var s=r(31109),l=r(64269);function i(e){let{className:t,...r}=e;return(0,a.jsx)(s.bL,{"data-slot":"tabs",className:(0,l.cn)("flex flex-col gap-2",t),...r})}function n(e){let{className:t,...r}=e;return(0,a.jsx)(s.B8,{"data-slot":"tabs-list",className:(0,l.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...r})}function d(e){let{className:t,...r}=e;return(0,a.jsx)(s.l9,{"data-slot":"tabs-trigger",className:(0,l.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...r})}function c(e){let{className:t,...r}=e;return(0,a.jsx)(s.UC,{"data-slot":"tabs-content",className:(0,l.cn)("flex-1 outline-none",t),...r})}},17037:(e,t,r)=>{"use strict";r.d(t,{F:()=>i});var a=r(95155);r(12115);var s=r(96898),l=r(64269);function i(e){let{className:t,children:r,...i}=e;return(0,a.jsxs)(s.bL,{"data-slot":"scroll-area",className:(0,l.cn)("relative",t),...i,children:[(0,a.jsx)(s.LM,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:r}),(0,a.jsx)(n,{}),(0,a.jsx)(s.OK,{})]})}function n(e){let{className:t,orientation:r="vertical",...i}=e;return(0,a.jsx)(s.VM,{"data-slot":"scroll-area-scrollbar",orientation:r,className:(0,l.cn)("flex touch-none p-px transition-colors select-none","vertical"===r&&"h-full w-2.5 border-l border-l-transparent","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent",t),...i,children:(0,a.jsx)(s.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}},18332:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>n,TN:()=>c,XL:()=>d});var a=r(95155);r(12115);var s=r(83101),l=r(64269);let i=(0,s.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function n(e){let{className:t,variant:r,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,l.cn)(i({variant:r}),t),...s})}function d(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"alert-title",className:(0,l.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",t),...r})}function c(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"alert-description",className:(0,l.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...r})}},23183:(e,t,r)=>{"use strict";r.d(t,{i:()=>a});let a=(0,r(99914).pY)()},32383:()=>{},64269:(e,t,r)=>{"use strict";r.d(t,{cn:()=>l});var a=r(2821),s=r(75889);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},83686:()=>{},86948:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>n,Zp:()=>l,aR:()=>i});var a=r(95155);r(12115);var s=r(64269);function l(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function i(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function n(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",t),...r})}function d(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",t),...r})}function c(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",t),...r})}}},e=>{e.O(0,[524,779,914,476,38,339,238,928,927,625,441,255,358],()=>e(e.s=1444)),_N_E=e.O()}]);